{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nvar _jsxFileName = \"/home/encora/Documents/projects/testDrive/tdn/pages/index.js\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\n/** @format */\nimport Head from 'next/head';\nimport styles from '../styles/Home.module.css';\nimport btnStyles from '../styles/Btn.module.css';\nimport Image from 'next/image'; // import 'bootstrap/dist/css/bootstrap.min.css'\n\nimport SechduleContent from '../common-component/sechduleDesc';\nimport StepBar from './../components/step-bar/stepBar';\nimport { carsTableBase, rooftopTableBase } from './api/utils/airtable';\nimport StepWizard from 'react-step-wizard';\nimport SelectCar from './../components/car-select/selectCar';\nimport PickDateTime from './../components/pick-date-time/pickDateTime';\nimport PickLocation from './../components/pick-location/pickLocation';\nimport BasicInfo from './../components/basic-info/basicInfo';\nimport CryptoJS from 'crypto-js';\nimport LicenseProof from './../components/licence-proof/licenceProof';\nimport UploadDl from './../components/licence-proof/uploadDl';\nimport DlUploadFront from './../components/licence-proof/dlUploadFront';\nimport DlUploadBack from './../components/licence-proof/dlUploadBack';\nimport DlVerify from './../components/dl-verify/dlVerify';\nimport ConfirmTestDrive from './../components/confirm-test-drive/confirmTestDrive';\nimport SetTestDrive from './../components/confirm-test-drive/setTestDrive';\nimport React, { useState, useRef } from 'react';\nimport Axios from 'axios';\nimport moment from 'moment';\nexport default function Home(props) {\n  const {\n    initialCarRecords,\n    rt,\n    error\n  } = props;\n  const myRef = useRef(null); // const goToTop = () => {\n  //   // window.scrollTo({ behavior: 'smooth', top: headRef.current.offsetTop });\n  //   headRef.current.scrollIntoView();\n  // };\n\n  const executeScroll = () => myRef.current.scrollIntoView({\n    block: 'start'\n  });\n\n  const [selectedCarData, setSelectedCarData] = React.useState({});\n  const {\n    0: currentPage,\n    1: setCurrentPage\n  } = useState(1);\n  const {\n    0: rooftopId,\n    1: setRooftopId\n  } = useState(rt);\n  const {\n    0: rooftopData,\n    1: setRooftopData\n  } = useState({});\n  const {\n    0: frontImageBase64,\n    1: setFrontImageBase64\n  } = useState('');\n  const [imageFile1, setImageFile1] = React.useState(null);\n  const {\n    0: onReload,\n    1: setOnReload\n  } = useState(false);\n  const {\n    0: userDataState,\n    1: setUserDataState\n  } = useState({});\n  const [imageFile2, setImageFile2] = React.useState(null);\n  const {\n    0: backImageBase64,\n    1: setBackImageBase64\n  } = useState('');\n  const {\n    0: somethingWrong,\n    1: setSomethingWrong\n  } = useState(false);\n  const {\n    0: selectedDateTime,\n    1: setSelectedDateTime\n  } = useState('');\n\n  if (error || !initialCarRecords || initialCarRecords.length <= 0) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      children: \"Unable to fetch data\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 56,\n      columnNumber: 12\n    }, this);\n  }\n\n  React.useEffect(() => {\n    console.log('changed user data state', userDataState);\n  }, [userDataState]);\n  React.useEffect(() => {\n    setOnReload(true);\n    let page = localStorage.getItem('currentPage');\n    let decryptedData, selectedTime, formObj;\n    const driveForm = localStorage.getItem('driveForm');\n\n    if (driveForm) {\n      let formObj = JSON.parse(driveForm);\n\n      if (formObj.time) {\n        selectedTime = formObj.time;\n      }\n    }\n\n    if (page) {\n      let bytes = CryptoJS.AES.decrypt(page, 'SECRET_KEY');\n\n      if (moment(selectedTime).isBefore(moment(new Date()))) {\n        // setCurrentPage(2);\n        setThisPage(2); // var ciphertext = CryptoJS.AES.encrypt(`2`, 'SECRET_KEY').toString();\n        // localStorage.setItem('currentPage', ciphertext);\n        // let form = { ...formObj, time: new Date() };\n        // localStorage.setItem('driveForm', JSON.stringify(form));\n        // setSelectedDateTime(new Date());\n      } else {\n        if (Math.sign(bytes.sigBytes) === -1 || bytes.sigBytes === 0) {\n          var ciphertext = CryptoJS.AES.encrypt(`1`, 'SECRET_KEY').toString();\n          localStorage.setItem('currentPage', ciphertext);\n        } else {\n          decryptedData = JSON.parse(bytes.toString(CryptoJS.enc.Utf8));\n        }\n\n        setCurrentPage(decryptedData || 1);\n        setSelectedDateTime(selectedTime);\n      }\n    }\n  }, [onReload]);\n  React.useEffect(() => {\n    console.log('changed ', {\n      rooftopId\n    });\n  }, [rooftopId]);\n  React.useEffect(() => {\n    console.log('changed ', {\n      selectedCarData\n    });\n  }, [selectedCarData]);\n  React.useEffect(async () => {\n    // const rooftopId = localStorage.getItem('rooftopId');\n    // setRooftopId(localStorage.getItem(rooftopId));\n    Axios.get(`/api/get-rooftop/${rooftopId}`).then(response => {\n      if (response.data && response.data.fields && response.data.fields.Timezone) {\n        const driveForm = localStorage.getItem(\"driveForm\");\n        let dupDriveForm = JSON.parse(driveForm);\n\n        let obj = _objectSpread(_objectSpread({}, dupDriveForm), {}, {\n          timeZone: response.data.fields.Timezone\n        });\n\n        localStorage.setItem(\"driveForm\", JSON.stringify(obj));\n      }\n\n      setRooftopData(response.data);\n    }, error => {\n      console.log(error);\n    });\n  }, []);\n  React.useEffect(() => {}, [frontImageBase64, backImageBase64]);\n\n  const setInitialPage = () => {\n    var ciphertext = CryptoJS.AES.encrypt(`1`, 'SECRET_KEY').toString();\n    localStorage.setItem('currentPage', ciphertext);\n    setCurrentPage(1);\n  };\n\n  const setNextPage = () => {\n    let page = currentPage + 1;\n    var ciphertext = CryptoJS.AES.encrypt(`${page}`, 'SECRET_KEY').toString();\n    localStorage.setItem('currentPage', ciphertext);\n    setCurrentPage(page);\n  };\n\n  const setPreviousPage = () => {\n    let page = currentPage - 1;\n    var ciphertext = CryptoJS.AES.encrypt(`${page}`, 'SECRET_KEY').toString();\n    localStorage.setItem('currentPage', ciphertext);\n    setCurrentPage(page);\n  };\n\n  const setThisPage = number => {\n    var ciphertext = CryptoJS.AES.encrypt(`${number}`, 'SECRET_KEY').toString();\n    localStorage.setItem('currentPage', ciphertext);\n    setCurrentPage(number);\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: styles.stepWizardContainer,\n    children: [/*#__PURE__*/_jsxDEV(Head, {\n      children: /*#__PURE__*/_jsxDEV(\"link\", {\n        href: \"https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css\",\n        rel: \"stylesheet\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 154,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 149,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n      ref: myRef\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 159,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(StepWizard, {\n      initialStep: currentPage,\n      children: [/*#__PURE__*/_jsxDEV(SelectCar, {\n        onReload: true,\n        initialCarRecords: initialCarRecords,\n        setSelectedCarData: setSelectedCarData,\n        setNextPage: setNextPage,\n        setThisPage: setThisPage,\n        currentPage: currentPage,\n        scrollToTop: executeScroll,\n        rooftopData: rooftopData\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 161,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(PickDateTime, {\n        onReload: true,\n        setNextPage: setNextPage,\n        setPreviousPage: setPreviousPage,\n        currentPage: currentPage,\n        setThisPage: setThisPage,\n        scrollToTop: executeScroll,\n        selectedCarData: selectedCarData,\n        selectedDateTime: selectedDateTime,\n        setSelectedDateTime: setSelectedDateTime\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 171,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(BasicInfo, {\n        onReload: true,\n        setNextPage: setNextPage,\n        setThisPage: setThisPage,\n        setPreviousPage: setPreviousPage,\n        currentPage: currentPage,\n        scrollToTop: executeScroll,\n        setUserDataState: setUserDataState\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 191,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(DlUploadFront, {\n        currentPage: currentPage,\n        setNextPage: setNextPage,\n        scrollToTop: executeScroll,\n        setThisPage: setThisPage,\n        frontImageBase64: frontImageBase64,\n        setFrontImageBase64: setFrontImageBase64,\n        setPreviousPage: setPreviousPage,\n        setImageFile1: setImageFile1,\n        imageFile1: imageFile1\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 205,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(DlUploadBack, {\n        scrollToTop: executeScroll,\n        currentPage: currentPage,\n        setThisPage: setThisPage,\n        setNextPage: setNextPage,\n        backImageBase64: backImageBase64,\n        setBackImageBase64: setBackImageBase64,\n        setPreviousPage: setPreviousPage,\n        setImageFile2: setImageFile2,\n        imageFile2: imageFile2\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 216,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(DlVerify, {\n        scrollToTop: executeScroll,\n        currentPage: currentPage,\n        backImageBase64: backImageBase64,\n        setBackImageBase64: setBackImageBase64,\n        frontImageBase64: frontImageBase64,\n        setFrontImageBase64: setFrontImageBase64,\n        setNextPage: setNextPage,\n        setImageFile2: setImageFile2,\n        setImageFile1: setImageFile1,\n        setThisPage: setThisPage,\n        setSomethingWrong: setSomethingWrong,\n        somethingWrong: somethingWrong\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 227,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(ConfirmTestDrive, {\n        currentPage: currentPage,\n        setNextPage: setNextPage,\n        scrollToTop: executeScroll,\n        selectedCarData: selectedCarData,\n        setImageFile2: setImageFile2,\n        setImageFile1: setImageFile1,\n        setThisPage: setThisPage,\n        rooftopData: rooftopData,\n        rt: rt,\n        selectedDateTime: selectedDateTime,\n        userDataState: userDataState,\n        setSomethingWrong: setSomethingWrong,\n        somethingWrong: somethingWrong\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 241,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(SetTestDrive, {\n        setInitialPage: setInitialPage,\n        currentPage: currentPage,\n        setThisPage: setThisPage,\n        scrollToTop: executeScroll,\n        selectedCarData: selectedCarData,\n        rooftopData: rooftopData,\n        selectedDateTime: selectedDateTime\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 256,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 160,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 148,\n    columnNumber: 5\n  }, this);\n}\nexport async function getServerSideProps(context) {\n  const {\n    rt\n  } = context.query;\n\n  try {\n    const rooftop = await rooftopTableBase.find(rt);\n    const promiseArray = rooftop.fields.Cars.map(carId => {\n      return new Promise(async (resolve, reject) => {\n        let res = {};\n\n        try {\n          res = await carsTableBase.find(carId);\n        } catch (err) {\n          console.log('promise array error', err);\n        } finally {\n          resolve({\n            id: res.id,\n            fields: res.fields\n          });\n        }\n      });\n    });\n    let rooftopCarsData = [];\n\n    try {\n      rooftopCarsData = await Promise.all(promiseArray);\n      rooftopCarsData.sort((a, b) => {\n        let fa = a.fields.Name.toLowerCase(),\n            fb = b.fields.Name.toLowerCase();\n\n        if (fa < fb) {\n          return -1;\n        }\n\n        if (fa > fb) {\n          return 1;\n        }\n\n        return 0;\n      }); // console.log(rooftopCarsData[0]);\n    } catch (err) {\n      console.log(err);\n    }\n\n    return {\n      props: {\n        initialCarRecords: rooftopCarsData,\n        rt // initialRooftopData: rooftop,\n\n      }\n    };\n  } catch (err) {\n    console.error(err);\n    return {\n      props: {\n        error: true\n      }\n    };\n  }\n}","map":{"version":3,"sources":["/home/encora/Documents/projects/testDrive/tdn/pages/index.js"],"names":["Head","styles","btnStyles","Image","SechduleContent","StepBar","carsTableBase","rooftopTableBase","StepWizard","SelectCar","PickDateTime","PickLocation","BasicInfo","CryptoJS","LicenseProof","UploadDl","DlUploadFront","DlUploadBack","DlVerify","ConfirmTestDrive","SetTestDrive","React","useState","useRef","Axios","moment","Home","props","initialCarRecords","rt","error","myRef","executeScroll","current","scrollIntoView","block","selectedCarData","setSelectedCarData","currentPage","setCurrentPage","rooftopId","setRooftopId","rooftopData","setRooftopData","frontImageBase64","setFrontImageBase64","imageFile1","setImageFile1","onReload","setOnReload","userDataState","setUserDataState","imageFile2","setImageFile2","backImageBase64","setBackImageBase64","somethingWrong","setSomethingWrong","selectedDateTime","setSelectedDateTime","length","useEffect","console","log","page","localStorage","getItem","decryptedData","selectedTime","formObj","driveForm","JSON","parse","time","bytes","AES","decrypt","isBefore","Date","setThisPage","Math","sign","sigBytes","ciphertext","encrypt","toString","setItem","enc","Utf8","get","then","response","data","fields","Timezone","dupDriveForm","obj","timeZone","stringify","setInitialPage","setNextPage","setPreviousPage","number","stepWizardContainer","getServerSideProps","context","query","rooftop","find","promiseArray","Cars","map","carId","Promise","resolve","reject","res","err","id","rooftopCarsData","all","sort","a","b","fa","Name","toLowerCase","fb"],"mappings":"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","sourcesContent":["/** @format */\n\nimport Head from 'next/head';\nimport styles from '../styles/Home.module.css';\nimport btnStyles from '../styles/Btn.module.css';\nimport Image from 'next/image';\n// import 'bootstrap/dist/css/bootstrap.min.css'\nimport SechduleContent from '../common-component/sechduleDesc';\nimport StepBar from './../components/step-bar/stepBar';\nimport { carsTableBase, rooftopTableBase } from './api/utils/airtable';\nimport StepWizard from 'react-step-wizard';\nimport SelectCar from './../components/car-select/selectCar';\nimport PickDateTime from './../components/pick-date-time/pickDateTime';\nimport PickLocation from './../components/pick-location/pickLocation';\nimport BasicInfo from './../components/basic-info/basicInfo';\nimport CryptoJS from 'crypto-js';\nimport LicenseProof from './../components/licence-proof/licenceProof';\nimport UploadDl from './../components/licence-proof/uploadDl';\nimport DlUploadFront from './../components/licence-proof/dlUploadFront';\nimport DlUploadBack from './../components/licence-proof/dlUploadBack';\nimport DlVerify from './../components/dl-verify/dlVerify';\nimport ConfirmTestDrive from './../components/confirm-test-drive/confirmTestDrive';\nimport SetTestDrive from './../components/confirm-test-drive/setTestDrive';\nimport React, { useState, useRef } from 'react';\nimport Axios from 'axios';\nimport moment from 'moment';\n\nexport default function Home(props) {\n  const { initialCarRecords, rt, error } = props;\n  const myRef = useRef(null);\n  // const goToTop = () => {\n  //   // window.scrollTo({ behavior: 'smooth', top: headRef.current.offsetTop });\n  //   headRef.current.scrollIntoView();\n  // };\n\n  const executeScroll = () => myRef.current.scrollIntoView({ block: 'start' });\n\n  const [selectedCarData, setSelectedCarData] = React.useState({});\n  const [currentPage, setCurrentPage] = useState(1);\n  const [rooftopId, setRooftopId] = useState(rt);\n  const [rooftopData, setRooftopData] = useState({});\n  const [frontImageBase64, setFrontImageBase64] = useState('');\n  const [imageFile1, setImageFile1] = React.useState(null);\n\n  const [onReload, setOnReload] = useState(false);\n  const [userDataState, setUserDataState] = useState({});\n\n  const [imageFile2, setImageFile2] = React.useState(null);\n  const [backImageBase64, setBackImageBase64] = useState('');\n\n  const [somethingWrong, setSomethingWrong] = useState(false);\n\n  const [selectedDateTime, setSelectedDateTime] = useState('');\n\n  if (error || !initialCarRecords || initialCarRecords.length <= 0) {\n    return <div>Unable to fetch data</div>;\n  }\n  React.useEffect(() => {\n    console.log('changed user data state', userDataState);\n  }, [userDataState]);\n\n  React.useEffect(() => {\n    setOnReload(true);\n    let page = localStorage.getItem('currentPage');\n    let decryptedData, selectedTime, formObj;\n    const driveForm = localStorage.getItem('driveForm');\n    if (driveForm) {\n      let formObj = JSON.parse(driveForm);\n      if (formObj.time) {\n        selectedTime = formObj.time;\n      }\n    }\n    if (page) {\n      let bytes = CryptoJS.AES.decrypt(page, 'SECRET_KEY');\n      if (moment(selectedTime).isBefore(moment(new Date()))) {\n        // setCurrentPage(2);\n        setThisPage(2)\n        // var ciphertext = CryptoJS.AES.encrypt(`2`, 'SECRET_KEY').toString();\n        // localStorage.setItem('currentPage', ciphertext);\n        // let form = { ...formObj, time: new Date() };\n        // localStorage.setItem('driveForm', JSON.stringify(form));\n        // setSelectedDateTime(new Date());\n      } else {\n        if (Math.sign(bytes.sigBytes) === -1 || bytes.sigBytes === 0) {\n          var ciphertext = CryptoJS.AES.encrypt(`1`, 'SECRET_KEY').toString();\n          localStorage.setItem('currentPage', ciphertext);\n        } else {\n          decryptedData = JSON.parse(bytes.toString(CryptoJS.enc.Utf8));\n        }\n        setCurrentPage(decryptedData || 1);\n        setSelectedDateTime(selectedTime);\n      }\n    }\n  }, [onReload]);\n\n  React.useEffect(() => {\n    console.log('changed ', { rooftopId });\n  }, [rooftopId]);\n\n  React.useEffect(() => {\n    console.log('changed ', { selectedCarData });\n  }, [selectedCarData]);\n\n  React.useEffect(async () => {\n    // const rooftopId = localStorage.getItem('rooftopId');\n    // setRooftopId(localStorage.getItem(rooftopId));\n\n    Axios.get(`/api/get-rooftop/${rooftopId}`).then(\n      (response) => {\n        if (response.data && response.data.fields && response.data.fields.Timezone) {\n          const driveForm = localStorage.getItem(\"driveForm\");\n          let dupDriveForm = JSON.parse(driveForm);\n          let obj = { ...dupDriveForm, timeZone: response.data.fields.Timezone };\n          localStorage.setItem(\"driveForm\", JSON.stringify(obj));\n        }\n        setRooftopData(response.data);\n      },\n      (error) => {\n        console.log(error);\n      }\n    );\n  }, []);\n  React.useEffect(() => { }, [frontImageBase64, backImageBase64]);\n\n  const setInitialPage = () => {\n    var ciphertext = CryptoJS.AES.encrypt(`1`, 'SECRET_KEY').toString();\n    localStorage.setItem('currentPage', ciphertext);\n    setCurrentPage(1);\n  };\n  const setNextPage = () => {\n    let page = currentPage + 1;\n    var ciphertext = CryptoJS.AES.encrypt(`${page}`, 'SECRET_KEY').toString();\n    localStorage.setItem('currentPage', ciphertext);\n    setCurrentPage(page);\n  };\n  const setPreviousPage = () => {\n    let page = currentPage - 1;\n    var ciphertext = CryptoJS.AES.encrypt(`${page}`, 'SECRET_KEY').toString();\n    localStorage.setItem('currentPage', ciphertext);\n    setCurrentPage(page);\n  };\n  const setThisPage = (number) => {\n    var ciphertext = CryptoJS.AES.encrypt(`${number}`, 'SECRET_KEY').toString();\n    localStorage.setItem('currentPage', ciphertext);\n    setCurrentPage(number);\n  };\n  return (\n    <div className={styles.stepWizardContainer}>\n      <Head>\n        {/* <script\n          src=\"https://apis.google.com/js/api.js\"\n          type=\"text/javascript\"\n        ></script> */}\n        <link\n          href=\"https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css\"\n          rel=\"stylesheet\"\n        />\n      </Head>\n      <span ref={myRef}></span>\n      <StepWizard initialStep={currentPage}>\n        <SelectCar\n          onReload\n          initialCarRecords={initialCarRecords}\n          setSelectedCarData={setSelectedCarData}\n          setNextPage={setNextPage}\n          setThisPage={setThisPage}\n          currentPage={currentPage}\n          scrollToTop={executeScroll}\n          rooftopData={rooftopData}\n        />\n        <PickDateTime\n          onReload\n          setNextPage={setNextPage}\n          setPreviousPage={setPreviousPage}\n          currentPage={currentPage}\n          setThisPage={setThisPage}\n          scrollToTop={executeScroll}\n          selectedCarData={selectedCarData}\n          selectedDateTime={selectedDateTime}\n          setSelectedDateTime={setSelectedDateTime}\n        />\n        {/* <PickLocation\n          setNextPage={setNextPage}\n          setPreviousPage={setPreviousPage}\n          setThisPage={setThisPage}\n          currentPage={currentPage}\n          scrollToTop={executeScroll}\n          rooftopData={rooftopData}\n          selectedCarData={selectedCarData}\n        /> */}\n        <BasicInfo\n          onReload\n          setNextPage={setNextPage}\n          setThisPage={setThisPage}\n          setPreviousPage={setPreviousPage}\n          currentPage={currentPage}\n          scrollToTop={executeScroll}\n          setUserDataState={setUserDataState}\n        />\n        {/* <LicenseProof\n          setPreviousPage={setPreviousPage}\n          scrollToTop={executeScroll}\n        />\n        <UploadDl scrollToTop={executeScroll} /> */}\n        <DlUploadFront\n          currentPage={currentPage}\n          setNextPage={setNextPage}\n          scrollToTop={executeScroll}\n          setThisPage={setThisPage}\n          frontImageBase64={frontImageBase64}\n          setFrontImageBase64={setFrontImageBase64}\n          setPreviousPage={setPreviousPage}\n          setImageFile1={setImageFile1}\n          imageFile1={imageFile1}\n        />\n        <DlUploadBack\n          scrollToTop={executeScroll}\n          currentPage={currentPage}\n          setThisPage={setThisPage}\n          setNextPage={setNextPage}\n          backImageBase64={backImageBase64}\n          setBackImageBase64={setBackImageBase64}\n          setPreviousPage={setPreviousPage}\n          setImageFile2={setImageFile2}\n          imageFile2={imageFile2}\n        />\n        <DlVerify\n          scrollToTop={executeScroll}\n          currentPage={currentPage}\n          backImageBase64={backImageBase64}\n          setBackImageBase64={setBackImageBase64}\n          frontImageBase64={frontImageBase64}\n          setFrontImageBase64={setFrontImageBase64}\n          setNextPage={setNextPage}\n          setImageFile2={setImageFile2}\n          setImageFile1={setImageFile1}\n          setThisPage={setThisPage}\n          setSomethingWrong={setSomethingWrong}\n          somethingWrong={somethingWrong}\n        />\n        <ConfirmTestDrive\n          currentPage={currentPage}\n          setNextPage={setNextPage}\n          scrollToTop={executeScroll}\n          selectedCarData={selectedCarData}\n          setImageFile2={setImageFile2}\n          setImageFile1={setImageFile1}\n          setThisPage={setThisPage}\n          rooftopData={rooftopData}\n          rt={rt}\n          selectedDateTime={selectedDateTime}\n          userDataState={userDataState}\n          setSomethingWrong={setSomethingWrong}\n          somethingWrong={somethingWrong}\n        />\n        <SetTestDrive\n          setInitialPage={setInitialPage}\n          currentPage={currentPage}\n          setThisPage={setThisPage}\n          scrollToTop={executeScroll}\n          selectedCarData={selectedCarData}\n          rooftopData={rooftopData}\n          selectedDateTime={selectedDateTime}\n        />\n      </StepWizard>\n\n      {/* <button onClick={executeScroll}>Go to top</button> */}\n    </div>\n  );\n}\n\nexport async function getServerSideProps(context) {\n  const { rt } = context.query;\n  try {\n    const rooftop = await rooftopTableBase.find(rt);\n    const promiseArray = rooftop.fields.Cars.map((carId) => {\n      return new Promise(async (resolve, reject) => {\n        let res = {};\n        try {\n          res = await carsTableBase.find(carId);\n        } catch (err) {\n          console.log('promise array error', err);\n        } finally {\n          resolve({ id: res.id, fields: res.fields });\n        }\n      });\n    });\n\n    let rooftopCarsData = [];\n    try {\n      rooftopCarsData = await Promise.all(promiseArray);\n      rooftopCarsData.sort((a, b) => {\n        let fa = a.fields.Name.toLowerCase(),\n          fb = b.fields.Name.toLowerCase();\n\n        if (fa < fb) {\n          return -1;\n        }\n        if (fa > fb) {\n          return 1;\n        }\n        return 0;\n      });\n      // console.log(rooftopCarsData[0]);\n    } catch (err) {\n      console.log(err);\n    }\n\n    return {\n      props: {\n        initialCarRecords: rooftopCarsData,\n        rt,\n        // initialRooftopData: rooftop,\n      },\n    };\n  } catch (err) {\n    console.error(err);\n    return {\n      props: {\n        error: true,\n      },\n    };\n  }\n}\n"]},"metadata":{},"sourceType":"module"}