{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\n\nvar _jsxFileName = \"/home/encora/Documents/projects/testDrive/tdn/components/confirm-test-drive/confirm.js\",\n    _this = this,\n    _s = $RefreshSig$();\n\n/** @format */\nimport Image from 'next/image';\nimport btnStyles from './../../styles/Btn.module.css';\nimport Axios from 'axios';\nimport moment from 'moment';\nimport React, { useState, useEffect } from 'react';\nimport { useUserData } from '../../contexts/UserDataContext';\nimport FontAwesome from 'react-fontawesome';\n\nvar ConfirmTestDrive = function ConfirmTestDrive(props) {\n  _s();\n\n  var data = useUserData();\n\n  var _useState = useState(false),\n      loading = _useState[0],\n      setLoading = _useState[1];\n\n  var _useState2 = useState({\n    address: '',\n    location: ''\n  }),\n      address = _useState2[0],\n      setAddress = _useState2[1]; // const sendTextMessage = (userData) => {\n  //   const textMessageData = {\n  //     firstName: userData.fields.FirstName,\n  //     lastName: userData.fields.LastName,\n  //     date: userData.fields.Date,\n  //     phone: userData.fields.Phone,\n  //   };\n  //   Axios.post('/api/sendTextMessage', textMessageData)\n  //     .then((res) => {\n  //       console.log('sent text message ', res.data);\n  //       localStorage.clear();\n  //     })\n  //     .catch((err) => {\n  //       console.log(err);\n  //       localStorage.clear();\n  //     });\n  // };\n\n\n  var sendConfirmationMessage = /*#__PURE__*/function () {\n    var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n      var userId,\n          userData,\n          _args = arguments;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              userId = _args.length > 0 && _args[0] !== undefined ? _args[0] : localStorage.getItem('userId');\n              setLoading(true);\n              _context.prev = 2;\n              _context.next = 5;\n              return Axios.get(\"/api/user/get-user/\".concat(userId));\n\n            case 5:\n              userData = _context.sent;\n              // console.log(userData.data);\n              createEvent(userData.data);\n              _context.next = 12;\n              break;\n\n            case 9:\n              _context.prev = 9;\n              _context.t0 = _context[\"catch\"](2);\n              console.log(_context.t0);\n\n            case 12:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, null, [[2, 9]]);\n    }));\n\n    return function sendConfirmationMessage() {\n      return _ref.apply(this, arguments);\n    };\n  }();\n\n  var createEvent = /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(userData) {\n      var rooftopData, carData, dealerData, location, dateVal, date, dateEpoch, userSelectedDate, selectedDateEpoch, currentTimeDifference, setEvent;\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              _context2.prev = 0;\n              _context2.next = 3;\n              return Axios.get(\"/api/get-rooftop/\".concat(props.rt));\n\n            case 3:\n              rooftopData = _context2.sent;\n              _context2.next = 6;\n              return Axios.get(\"/api/get-car/\".concat(localStorage.getItem('carId')));\n\n            case 6:\n              carData = _context2.sent;\n              _context2.next = 9;\n              return Axios.get(\"/api/get-dealership/\".concat(rooftopData.data.fields['Dealership Group'][0]));\n\n            case 9:\n              dealerData = _context2.sent;\n              location = userData.fields && userData.fields['At Home'] && userData.fields['At Home'] === true ? userData.fields.Address : rooftopData.data.fields.Address;\n              dateVal = Math.floor(new Date().getTime() / 1000.0);\n              date = moment.unix(dateVal);\n              dateEpoch = date.tz(rooftopData.data.fields.Timezone).unix();\n              userSelectedDate = moment(new Date(userData.fields.Date));\n              selectedDateEpoch = userSelectedDate.tz(rooftopData.data.fields.Timezone).unix().toString();\n              currentTimeDifference = Math.floor((selectedDateEpoch - dateEpoch) / 60).toString(); // console.log(\n              //   'log date FE ',\n              //   typeof dateEpoch,\n              //   typeof selectedDateEpoch,\n              //   typeof currentTimeDifference\n              // );\n\n              _context2.next = 19;\n              return Axios.post('/api/user/createEvent', {\n                location: location,\n                userData: userData,\n                carData: carData.data,\n                rooftopData: rooftopData.data,\n                dealerData: dealerData,\n                selectedTime: selectedTime,\n                selectedDate: selectedDate,\n                currentTimeDifference: currentTimeDifference,\n                selectedDateEpoch: selectedDateEpoch\n              });\n\n            case 19:\n              setEvent = _context2.sent;\n              // const setEvent = await Axios.post('/api/user/nylusTest', {\n              //   location,\n              //   userData,\n              //   carData: carData.data,\n              //   rooftopData: rooftopData.data,\n              //   dealerData,\n              //   selectedTime,\n              //   selectedDate,\n              // });\n              setLoading(false);\n              props.setThisPage(9);\n              props.nextStep();\n              _context2.next = 29;\n              break;\n\n            case 25:\n              _context2.prev = 25;\n              _context2.t0 = _context2[\"catch\"](0);\n              console.log('error log', _context2.t0);\n              setLoading(false);\n\n            case 29:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2, null, [[0, 25]]);\n    }));\n\n    return function createEvent(_x) {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  var _useState3 = useState(''),\n      selectedDate = _useState3[0],\n      setSelectedDate = _useState3[1];\n\n  var _useState4 = useState(''),\n      selectedTime = _useState4[0],\n      setSelectedTime = _useState4[1];\n\n  useEffect(function () {\n    var driveForm = localStorage.getItem('driveForm');\n    var dupDriveForm = JSON.parse(driveForm);\n\n    if (dupDriveForm) {\n      var timeSlot = moment(props.selectedDateTime).tz(dupDriveForm.timeZone).format('LT');\n      var date = moment(props.selectedDateTime).format('dddd, MMMM DD');\n\n      if (date) {\n        setSelectedDate(date);\n      }\n\n      if (timeSlot) {\n        setSelectedTime(timeSlot);\n      }\n    }\n\n    if (props.isActive) {\n      var _driveForm = localStorage.getItem('driveForm');\n\n      var _dupDriveForm = JSON.parse(_driveForm);\n\n      if (_dupDriveForm.atHome) {\n        setAddress({\n          location: 'At Home',\n          address: _dupDriveForm.address\n        });\n      } else {\n        setAddress({\n          location: props.rooftopData && props.rooftopData.fields && props.rooftopData.fields.Name,\n          address: props.rooftopData && props.rooftopData.fields && props.rooftopData.fields.Address\n        });\n      }\n    }\n  }, [props.isActive]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      display: \"\".concat(props.currentPage === 8 ? 'block' : 'none')\n    },\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"container-fluid bggray d-flex justify-content-center height100vh overflow-auto\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"bgwhite centerDiv1\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n            className: \"confirm-heading\",\n            children: \"Confirm your Test Drive\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 162,\n            columnNumber: 13\n          }, _this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"row\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"col-sm-12 col-md-6 col-lg-6 displaynone\",\n              children: /*#__PURE__*/_jsxDEV(\"div\", {\n                children: /*#__PURE__*/_jsxDEV(\"iframe\", {\n                  className: \"confirmMap\",\n                  src: address.location === 'At Home' ? \"https://maps.google.com/maps?q=\".concat(escape(address.address), \"&t=&z=13&ie=UTF8&iwloc=&output=embed\") : props.rooftopData && props.rooftopData.fields && props.rooftopData.fields.Geolocation,\n                  width: \"600\",\n                  height: \"420\",\n                  frameBorder: \"0\",\n                  allowFullScreen: \"\",\n                  \"aria-hidden\": \"false\",\n                  tabIndex: \"0\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 166,\n                  columnNumber: 19\n                }, _this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 165,\n                columnNumber: 17\n              }, _this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 164,\n              columnNumber: 15\n            }, _this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"col-sm-12 col-md-6 col-lg-6 ipadView\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"confirmCar\",\n                children: props.selectedCarData && props.selectedCarData.fields && /*#__PURE__*/_jsxDEV(Image, {\n                  style: {\n                    borderRadius: '20px'\n                  },\n                  src: props.selectedCarData && props.selectedCarData.fields && props.selectedCarData.fields.Image[0].url,\n                  alt: \"\",\n                  height: 350,\n                  width: 600 // width=\"100%\"\n\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 193,\n                  columnNumber: 21\n                }, _this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 191,\n                columnNumber: 17\n              }, _this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"mapAddress\",\n                children: [/*#__PURE__*/_jsxDEV(\"p\", {\n                  children: address && address.location\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 208,\n                  columnNumber: 19\n                }, _this), /*#__PURE__*/_jsxDEV(\"p\", {\n                  children: address && address.address\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 209,\n                  columnNumber: 19\n                }, _this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 207,\n                columnNumber: 17\n              }, _this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"confirmDate\",\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"monthandDateContent\",\n                  children: [\" \", selectedDate]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 212,\n                  columnNumber: 19\n                }, _this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"timeVIewContainer\",\n                  children: selectedTime ? selectedTime.toLowerCase() : null\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 213,\n                  columnNumber: 19\n                }, _this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 211,\n                columnNumber: 17\n              }, _this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 190,\n              columnNumber: 15\n            }, _this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 163,\n            columnNumber: 13\n          }, _this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"btnSecconfirm\",\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"flexBt\",\n              children: [/*#__PURE__*/_jsxDEV(\"button\", {\n                type: \"button\",\n                className: btnStyles.secondary,\n                onClick: function onClick() {\n                  props.setImageFile2(null);\n                  props.setImageFile1(null);\n                  props.setThisPage(4);\n                  props.setSomethingWrong(false);\n                  props.goToStep(4);\n                },\n                children: \"Back\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 221,\n                columnNumber: 17\n              }, _this), /*#__PURE__*/_jsxDEV(\"button\", {\n                type: \"button\",\n                className: btnStyles.primary,\n                onClick: function onClick() {\n                  return sendConfirmationMessage();\n                },\n                disabled: loading,\n                children: loading ? /*#__PURE__*/_jsxDEV(FontAwesome, {\n                  name: \"fas fa-spinner fa-pulse\",\n                  spin: true\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 242,\n                  columnNumber: 21\n                }, _this) : 'Continue'\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 235,\n                columnNumber: 17\n              }, _this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 220,\n              columnNumber: 15\n            }, _this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 219,\n            columnNumber: 13\n          }, _this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 161,\n          columnNumber: 11\n        }, _this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 160,\n        columnNumber: 9\n      }, _this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 159,\n      columnNumber: 7\n    }, _this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 158,\n    columnNumber: 5\n  }, _this);\n};\n\n_s(ConfirmTestDrive, \"chlnMhGs7g5vWZMQROKDdEPHCV4=\", false, function () {\n  return [useUserData];\n});\n\n_c = ConfirmTestDrive;\nexport default ConfirmTestDrive;\n\nvar _c;\n\n$RefreshReg$(_c, \"ConfirmTestDrive\");","map":{"version":3,"sources":["/home/encora/Documents/projects/testDrive/tdn/components/confirm-test-drive/confirm.js"],"names":["Image","btnStyles","Axios","moment","React","useState","useEffect","useUserData","FontAwesome","ConfirmTestDrive","props","data","loading","setLoading","address","location","setAddress","sendConfirmationMessage","userId","localStorage","getItem","get","userData","createEvent","console","log","rt","rooftopData","carData","fields","dealerData","Address","dateVal","Math","floor","Date","getTime","date","unix","dateEpoch","tz","Timezone","userSelectedDate","selectedDateEpoch","toString","currentTimeDifference","post","selectedTime","selectedDate","setEvent","setThisPage","nextStep","setSelectedDate","setSelectedTime","driveForm","dupDriveForm","JSON","parse","timeSlot","selectedDateTime","timeZone","format","isActive","atHome","Name","display","currentPage","escape","Geolocation","selectedCarData","borderRadius","url","toLowerCase","secondary","setImageFile2","setImageFile1","setSomethingWrong","goToStep","primary"],"mappings":"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","sourcesContent":["/** @format */\nimport Image from 'next/image';\nimport btnStyles from './../../styles/Btn.module.css';\nimport Axios from 'axios';\nimport moment from 'moment';\nimport React, { useState, useEffect } from 'react';\nimport { useUserData } from '../../contexts/UserDataContext';\nimport FontAwesome from 'react-fontawesome';\n\nconst ConfirmTestDrive = (props) => {\n  const data = useUserData();\n\n  const [loading, setLoading] = useState(false);\n\n  const [address, setAddress] = useState({ address: '', location: '' });\n\n  // const sendTextMessage = (userData) => {\n  //   const textMessageData = {\n  //     firstName: userData.fields.FirstName,\n  //     lastName: userData.fields.LastName,\n  //     date: userData.fields.Date,\n  //     phone: userData.fields.Phone,\n  //   };\n  //   Axios.post('/api/sendTextMessage', textMessageData)\n  //     .then((res) => {\n  //       console.log('sent text message ', res.data);\n  //       localStorage.clear();\n  //     })\n  //     .catch((err) => {\n  //       console.log(err);\n  //       localStorage.clear();\n  //     });\n  // };\n\n  const sendConfirmationMessage = async (\n    userId = localStorage.getItem('userId')\n  ) => {\n    setLoading(true);\n    let userData;\n    try {\n      userData = await Axios.get(`/api/user/get-user/${userId}`);\n      // console.log(userData.data);\n      createEvent(userData.data);\n    } catch (err) {\n      console.log(err);\n    }\n    // if (userData.data && userData.data.fields) {\n    //   createEvent(userData.data);\n    // }\n  };\n  const createEvent = async (userData) => {\n    try {\n      const rooftopData = await Axios.get(`/api/get-rooftop/${props.rt}`);\n      const carData = await Axios.get(\n        `/api/get-car/${localStorage.getItem('carId')}`\n      );\n      const dealerData = await Axios.get(\n        `/api/get-dealership/${rooftopData.data.fields['Dealership Group'][0]}`\n      );\n\n      const location =\n        userData.fields &&\n        userData.fields['At Home'] &&\n        userData.fields['At Home'] === true\n          ? userData.fields.Address\n          : rooftopData.data.fields.Address;\n\n      let dateVal = Math.floor(new Date().getTime() / 1000.0);\n      let date = moment.unix(dateVal);\n      let dateEpoch = date.tz(rooftopData.data.fields.Timezone).unix();\n\n      let userSelectedDate = moment(new Date(userData.fields.Date));\n      let selectedDateEpoch = userSelectedDate\n        .tz(rooftopData.data.fields.Timezone)\n        .unix()\n        .toString();\n\n      let currentTimeDifference = Math.floor(\n        (selectedDateEpoch - dateEpoch) / 60\n      ).toString();\n\n      // console.log(\n      //   'log date FE ',\n      //   typeof dateEpoch,\n      //   typeof selectedDateEpoch,\n      //   typeof currentTimeDifference\n      // );\n\n      const setEvent = await Axios.post('/api/user/createEvent', {\n        location,\n        userData,\n        carData: carData.data,\n        rooftopData: rooftopData.data,\n        dealerData,\n        selectedTime,\n        selectedDate,\n        currentTimeDifference,\n        selectedDateEpoch,\n      });\n\n      // const setEvent = await Axios.post('/api/user/nylusTest', {\n      //   location,\n      //   userData,\n      //   carData: carData.data,\n      //   rooftopData: rooftopData.data,\n      //   dealerData,\n      //   selectedTime,\n      //   selectedDate,\n      // });\n      setLoading(false);\n      props.setThisPage(9);\n      props.nextStep();\n    } catch (err) {\n      console.log('error log', err);\n      setLoading(false);\n    }\n  };\n\n  const [selectedDate, setSelectedDate] = useState('');\n  const [selectedTime, setSelectedTime] = useState('');\n\n  useEffect(() => {\n    const driveForm = localStorage.getItem('driveForm');\n    let dupDriveForm = JSON.parse(driveForm);\n    if (dupDriveForm) {\n      let timeSlot = moment(props.selectedDateTime)\n        .tz(dupDriveForm.timeZone)\n        .format('LT');\n      let date = moment(props.selectedDateTime).format('dddd, MMMM DD');\n      if (date) {\n        setSelectedDate(date);\n      }\n      if (timeSlot) {\n        setSelectedTime(timeSlot);\n      }\n    }\n    if (props.isActive) {\n      const driveForm = localStorage.getItem('driveForm');\n      let dupDriveForm = JSON.parse(driveForm);\n      if (dupDriveForm.atHome) {\n        setAddress({ location: 'At Home', address: dupDriveForm.address });\n      } else {\n        setAddress({\n          location:\n            props.rooftopData &&\n            props.rooftopData.fields &&\n            props.rooftopData.fields.Name,\n          address:\n            props.rooftopData &&\n            props.rooftopData.fields &&\n            props.rooftopData.fields.Address,\n        });\n      }\n    }\n  }, [props.isActive]);\n\n  return (\n    <div style={{ display: `${props.currentPage === 8 ? 'block' : 'none'}` }}>\n      <div className=\"container-fluid bggray d-flex justify-content-center height100vh overflow-auto\">\n        <div className=\"bgwhite centerDiv1\">\n          <div>\n            <h1 className=\"confirm-heading\">Confirm your Test Drive</h1>\n            <div className=\"row\">\n              <div className=\"col-sm-12 col-md-6 col-lg-6 displaynone\">\n                <div>\n                  <iframe\n                    className=\"confirmMap\"\n                    src={\n                      address.location === 'At Home'\n                        ? `https://maps.google.com/maps?q=${escape(\n                            address.address\n                          )}&t=&z=13&ie=UTF8&iwloc=&output=embed`\n                        : props.rooftopData &&\n                          props.rooftopData.fields &&\n                          props.rooftopData.fields.Geolocation\n                    }\n                    width=\"600\"\n                    height=\"420\"\n                    frameBorder=\"0\"\n                    allowFullScreen=\"\"\n                    aria-hidden=\"false\"\n                    tabIndex=\"0\"\n                  ></iframe>\n                </div>\n\n                {/* <div className=\"infoText\">\n              <p>*you can change your appointment time if needed</p>\n            </div> */}\n              </div>\n              <div className=\"col-sm-12 col-md-6 col-lg-6 ipadView\">\n                <div className=\"confirmCar\">\n                  {props.selectedCarData && props.selectedCarData.fields && (\n                    <Image\n                      style={{ borderRadius: '20px' }}\n                      src={\n                        props.selectedCarData &&\n                        props.selectedCarData.fields &&\n                        props.selectedCarData.fields.Image[0].url\n                      }\n                      alt=\"\"\n                      height={350}\n                      width={600}\n                      // width=\"100%\"\n                    />\n                  )}\n                </div>\n                <div className=\"mapAddress\">\n                  <p>{address && address.location}</p>\n                  <p>{address && address.address}</p>\n                </div>\n                <div className=\"confirmDate\">\n                  <div className=\"monthandDateContent\"> {selectedDate}</div>\n                  <div className=\"timeVIewContainer\">\n                    {selectedTime ? selectedTime.toLowerCase() : null}\n                  </div>\n                </div>\n              </div>\n            </div>\n            <div className=\"btnSecconfirm\">\n              <div className=\"flexBt\">\n                <button\n                  type=\"button\"\n                  className={btnStyles.secondary}\n                  onClick={() => {\n                    props.setImageFile2(null);\n                    props.setImageFile1(null);\n                    props.setThisPage(4);\n                    props.setSomethingWrong(false);\n\n                    props.goToStep(4);\n                  }}\n                >\n                  Back\n                </button>\n                <button\n                  type=\"button\"\n                  className={btnStyles.primary}\n                  onClick={() => sendConfirmationMessage()}\n                  disabled={loading}\n                >\n                  {loading ? (\n                    <FontAwesome name=\"fas fa-spinner fa-pulse\" spin />\n                  ) : (\n                    'Continue'\n                  )}\n                </button>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default ConfirmTestDrive;\n"]},"metadata":{},"sourceType":"module"}